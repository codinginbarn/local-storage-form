<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="Demo of storage-form Web Component" />
		<title>storage-form Web Component Demo</title>

		<style>
			:root[data-theme="dark"] {
				background: black;
				color: white;
			}
			
			:root[data-theme="light"] {
				background: #f4f4f4;
			}
			
			:root[data-contrast="true"] * {
				font-weight: bold;
			}
			
			output {
				font-family: monospace;
			}
		</style>

		<script type="module" src="storage-form.js"></script>
	</head>
	<body>
		<storage-form>
			<form>
				<label>
					Example
					<input type="text" name="example" value="value">
				</label>
				<button>Submit</button>
			</form>
		</storage-form>

		<hr>

		<storage-form>
			<form>
				<label>
					<input type="radio" name="theme" value="dark">
					<span>Dark mode</span>
				</label>
				<label>
					<input type="radio" name="theme" value="light">
					<span>Light mode</span>
				</label>
				<label>
					<input type="radio" name="theme" value="" checked>
					<span>Default mode</span>
				</label>
				<br>
				<label>
					<input type="hidden" name="contrast" value>
					<input type="checkbox" name="contrast" value="true">
					<span>High contrast</span>
				</label>
			</form>
		</storage-form>

		<hr>

		<output></output>

		<script>
			const updatePage = () => {
				
				const options = ["theme", "contrast"];
				for (let option of options) {
					
					// Update root attributes
					document.documentElement.dataset[option] = window.localStorage[option] || "";
					
					// Update form state
					document.querySelector(
						`[name='${option}'][value='${window.localStorage[option] || ""}']`
					).checked = true;
				};
				
				// Update output to demonstrate
				document.querySelector("output").innerHTML = JSON.stringify(window.localStorage);
			};
			window.addEventListener("storage", updatePage);
			updatePage();
		</script>
	</body>
</html>
